# Sleep Disorder Predictor  
### RandomForest + SHAP + LLM (FastAPI)

A full-stack **machine learning portfolio project** that predicts sleep disorder categories and explains *why* the prediction was made.

The system combines:
- A **scikit-learn RandomForest model** for prediction
- **SHAP** for model-grounded feature importance
- An **LLM** to translate SHAP outputs into human-readable explanations
- A **FastAPI backend** and a lightweight HTML frontend

> Educational project only. Not medical advice.

---

## Features

- Predicts sleep disorder category:
  - `None`
  - `Insomnia`
  - `Sleep Apnea`
- `/predict` ‚Üí fast prediction only  
- `/predict_with_explanation` ‚Üí prediction + SHAP + LLM explanation  
- Clear separation of **model logic**, **explainability**, and **presentation**
- Beginner-friendly UI with real-time API calls

---

## How It Works (High Level)

1. User enters lifestyle and health information
2. Backend converts inputs to the exact format used during training
3. RandomForest model predicts the sleep disorder class
4. SHAP identifies the most influential features for that prediction
5. An LLM converts those factors into a simple, human-readable explanation
6. Results are returned to the frontend

This keeps explanations **grounded in the model**, not guesses.

---

## üõ† Tech Stack

**Backend**
- Python 3.11
- FastAPI
- scikit-learn
- pandas, numpy
- SHAP
- OpenAI SDK (LLM explanations)

**Frontend**
- HTML + CSS
- Vanilla JavaScript (Fetch API)

---

## üìÅ Project Structure

```
sleep-disorder-predictor/
‚îÇ
‚îú‚îÄ‚îÄ app.py
‚îú‚îÄ‚îÄ train.py
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ .env.example
‚îÇ
‚îú‚îÄ‚îÄ artifacts/             # Generated by train.py (ignored by git)
‚îÇ   ‚îú‚îÄ‚îÄ sleep_disorder_pipeline.joblib
‚îÇ   ‚îî‚îÄ‚îÄ shap_background.joblib
‚îÇ
‚îî‚îÄ‚îÄ web/
    ‚îî‚îÄ‚îÄ index.html
```

---

## ‚öôÔ∏è Setup Instructions

### 1Ô∏è‚É£ Create virtual environment
```bash
python3.11 -m venv venv
source venv/bin/activate
```

### 2Ô∏è‚É£ Install dependencies
```bash
pip install -r requirements.txt
```

---

## Environment Variables

Create a `.env` file:
```bash
cp .env.example .env
```

Add your key:
```env
OPENAI_API_KEY=your_openai_api_key_here
```

> ‚ö†Ô∏è Never commit `.env` to GitHub.

---

## Train the Model

```bash
python train.py
```

This generates model artifacts in `/artifacts`.

---

## Run the API

```bash
python -m uvicorn app:app --reload --port 8000
```

Endpoints:
- Health ‚Üí `/health`
- Docs ‚Üí `/docs`
- Predict ‚Üí `/predict`
- Predict + Explain ‚Üí `/predict_with_explanation`

---

## Run the Frontend

Open:
```
web/index.html
```

Ensure the API runs at `http://127.0.0.1:8000`.

---

## Explainability Design

- SHAP grounds explanations in model behavior
- LLM translates technical factors into human language
- Guardrails prevent hallucination or diagnosis

---

## Disclaimer

This project is for educational purposes only and does **not** provide medical advice, diagnosis, or treatment.
